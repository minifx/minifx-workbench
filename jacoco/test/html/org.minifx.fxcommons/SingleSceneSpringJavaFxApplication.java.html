<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SingleSceneSpringJavaFxApplication.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">minifx-workbench</a> &gt; <a href="index.source.html" class="el_package">org.minifx.fxcommons</a> &gt; <span class="el_source">SingleSceneSpringJavaFxApplication.java</span></div><h1>SingleSceneSpringJavaFxApplication.java</h1><pre class="source lang-java linenums">package org.minifx.fxcommons;

import static java.util.Objects.requireNonNull;

import java.util.Arrays;
import java.util.function.Consumer;

import org.minifx.workbench.domain.Perspective;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.stereotype.Component;

import javafx.application.Application;
import javafx.scene.Scene;
import javafx.stage.Stage;
import javafx.stage.WindowEvent;

/**
 * Entry point for JavaFx applications that make use of Spring IOC for dependency injection. In order to use this class
 * call {@link #applicationLauncher()} in order to get the static builder initializer. Use
 * {@link FxLauncher#launch(String...)} in order to start the JavaFx application. Once started, a Spring context is
 * created and a {@link Scene} bean is created. Use the {@link Perspective} beans to build your application. In order to
 * customize the JavaFx {@link Stage}, use the {@link FxLauncher}.
 *
 * @author acalia, mgalilee
 */
@Component
<span class="nc" id="L27">public class SingleSceneSpringJavaFxApplication extends Application {</span>

<span class="nc" id="L29">    public static final Consumer&lt;WindowEvent&gt; EXIT_ON_CLOSE = ev -&gt; System.exit(0);</span>
<span class="nc" id="L30">    private static final FxLauncher LAUNCHER = new FxLauncher();</span>

    @Override
    public void start(Stage primaryStage) throws Exception {
<span class="nc bnc" id="L34" title="All 2 branches missed.">        if (!LAUNCHER.readyToLaunch) {</span>
<span class="nc" id="L35">            throw new RuntimeException(</span>
                    &quot;Use the builder to configure the JavaFx application. Do not call directly Application.launch(...)&quot;);
        }

        @SuppressWarnings(&quot;resource&quot;) /* Closed automatically by the hook */
<span class="nc" id="L40">                AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext(LAUNCHER.configurationClasses);</span>
        /* Spring context register itself in the shutdown hook. It automatically keeps a reference to it this way */
<span class="nc" id="L42">        ctx.registerShutdownHook();</span>
<span class="nc" id="L43">        Scene mainScene = ctx.getBean(Scene.class);</span>
<span class="nc" id="L44">        primaryStage.setScene(mainScene);</span>
<span class="nc" id="L45">        primaryStage.sizeToScene();</span>
<span class="nc" id="L46">        primaryStage.show();</span>
<span class="nc" id="L47">        primaryStage.setOnCloseRequest(LAUNCHER.windowCloseHandler::accept);</span>
<span class="nc" id="L48">        primaryStage.setTitle(LAUNCHER.windowTitle);</span>
<span class="nc" id="L49">    }</span>

    /**
     * Returns the static builder of {@link SingleSceneSpringJavaFxApplication}. Use this method to configure and launch
     * a {@link SingleSceneSpringJavaFxApplication}.
     *
     * @return the single instance of the application launcher
     */
    public static FxLauncher applicationLauncher() {
<span class="nc" id="L58">        return LAUNCHER;</span>
    }

<span class="nc" id="L61">    public static class FxLauncher {</span>
<span class="nc" id="L62">        private Class&lt;?&gt;[] configurationClasses = new Class&lt;?&gt;[0];</span>
<span class="nc" id="L63">        private String windowTitle = &quot;&quot;;</span>
<span class="nc" id="L64">        private Consumer&lt;WindowEvent&gt; windowCloseHandler = EXIT_ON_CLOSE;</span>
<span class="nc" id="L65">        private boolean readyToLaunch = false;</span>

        public FxLauncher configurationClasses(Class&lt;?&gt;... _configurationClasses) {
<span class="nc" id="L68">            requireNonNull(_configurationClasses, &quot;configurationClasses must not be null&quot;);</span>
<span class="nc bnc" id="L69" title="All 2 branches missed.">            if (_configurationClasses.length &lt; 1) {</span>
<span class="nc" id="L70">                throw new IllegalArgumentException(&quot;There must be at least one configuration class.&quot;);</span>
            }
<span class="nc" id="L72">            this.configurationClasses = Arrays.copyOf(_configurationClasses, _configurationClasses.length);</span>
<span class="nc" id="L73">            return this;</span>
        }

        public FxLauncher windowTitle(String _windowTitle) {
<span class="nc" id="L77">            this.windowTitle = _windowTitle;</span>
<span class="nc" id="L78">            return this;</span>
        }

        public FxLauncher windowCloseHandler(Consumer&lt;WindowEvent&gt; _windowCloseHandler) {
<span class="nc" id="L82">            this.windowCloseHandler = _windowCloseHandler;</span>
<span class="nc" id="L83">            return this;</span>
        }

        /**
         * Use {@link Application#launch(String...)} to start {@link SingleSceneSpringJavaFxApplication}.
         *
         * @param args the command line arguments to be passed to the application
         */
        public void launch(String... args) {
<span class="nc" id="L92">            this.readyToLaunch = true;</span>
<span class="nc" id="L93">            Application.launch(SingleSceneSpringJavaFxApplication.class, args);</span>
<span class="nc" id="L94">        }</span>

    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>